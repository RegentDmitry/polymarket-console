# Earthquake Trading Bot

TUI-бот для торговли на Polymarket по рынкам землетрясений. Использует сейсмические данные USGS для генерации торговых сигналов.

## Требования

- Python 3.10+
- Linux / WSL / macOS

## Установка

### 1. Создание виртуального окружения

```bash
cd earthquake_bot
python3 -m venv .venv
source .venv/bin/activate
```

### 2. Установка зависимостей

```bash
pip install -r bot/requirements.txt
```

### 3. Настройка переменных окружения

Скопируйте файл `.env.example` в `.env` и заполните необходимые значения:

```bash
cp .env.example .env
nano .env  # или любой другой редактор
```

**Обязательные переменные для торговли:**

| Переменная | Описание |
|------------|----------|
| `PK` | Приватный ключ кошелька Polymarket |
| `CLOB_API_KEY` | API ключ CLOB |
| `CLOB_SECRET` | Секрет CLOB |
| `CLOB_PASS_PHRASE` | Пароль CLOB |

**Опциональные:**

| Переменная | Описание |
|------------|----------|
| `DUNE_API_KEY` | Для истории сделок |
| `POLYGON_RPC` | RPC для блокчейна (по умолчанию публичный) |

## Запуск

Из директории `earthquake_bot`:

```bash
# Активировать venv если ещё не активирован
source .venv/bin/activate

# Запуск в режиме DRY RUN (по умолчанию, без реальных сделок)
python -m bot

# Запуск с live-торговлей (с подтверждением каждой сделки)
python -m bot --live

# Полностью автоматический режим (без подтверждений)
python -m bot --live --auto
```

## Параметры командной строки

| Флаг | Короткий | Описание | По умолчанию |
|------|----------|----------|--------------|
| `--interval` | `-i` | Интервал сканирования (30s, 5m, 1h) | `5m` |
| `--live` | `-l` | Включить реальную торговлю | выкл (dry-run) |
| `--auto` | `-a` | Авто-режим без подтверждений | выкл |
| `--max-positions` | `-m` | Максимум открытых позиций | `20` |
| `--min-edge` | | Минимальный edge для входа | `0.01` (1%) |
| `--min-apy` | | Минимальный APY для входа | `0.30` (30%) |
| `--data-dir` | | Директория для данных | `bot/data` |

## Примеры

```bash
# Сканирование каждую минуту
python -m bot --interval 1m

# Строгие параметры входа
python -m bot --min-edge 0.02 --min-apy 0.50

# Полный пример
python -m bot --live --interval 5m --min-edge 0.05 --min-apy 0.25 --max-positions 10
```

## Режимы работы

| Режим | Описание |
|-------|----------|
| **DRY RUN** | Показывает сигналы, но не выполняет сделки. По умолчанию. |
| **CONFIRM** | Реальная торговля с подтверждением каждой сделки (`--live`) |
| **AUTO** | Автоматическое исполнение без подтверждений (`--live --auto`) |

## Управление в TUI

| Клавиша | Действие |
|---------|----------|
| `Q` | Выход (подтверждение через Enter) |
| `R` | Запустить сканирование |
| `H` | Показать статистику |
| `M` | Переключить режим AUTO/CONFIRM |
| `Y/N` | Подтвердить/отклонить сделку |

Интерфейс показывает: текущие сигналы, открытые позиции, баланс

## Структура

```
bot/
├── __main__.py      # Точка входа
├── config.py        # Конфигурация и CLI
├── scanner/         # Сканеры сигналов (USGS)
├── executor/        # Исполнение сделок (Polymarket)
├── models/          # Модели данных
├── storage/         # Хранение позиций
├── ui/              # TUI интерфейс (Textual)
└── data/            # Данные позиций
```

## Troubleshooting

**Ошибка "No API credentials":**
Убедитесь, что в `.env` заполнены все CLOB переменные.

**Ошибка импорта модулей:**
Запускайте из директории `earthquake_bot`, не из `bot/`.

**TUI не отображается корректно:**
Убедитесь, что терминал поддерживает 256 цветов и Unicode.
